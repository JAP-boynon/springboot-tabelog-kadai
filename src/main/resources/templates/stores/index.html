<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
     <div th:replace="~{fragment :: meta}"></div>
    <div th:replace="~{fragment :: styles}"></div>
    <title>店舗一覧</title>
</head>

<body>

   <div th:replace="~{fragment :: header}"></div>

<main class="container pt-4 pb-5">

    <h2>店舗一覧</h2>

    <!-- 検索フォーム -->
    <form method="get" action="/stores" class="search-form">

        <!-- 店舗名検索 -->
        <input
            type="text"
            name="keyword"
            class="keyword-input"
            placeholder="店舗名"
            th:value="${keyword}"
        >

        <!-- カテゴリ選択 -->
        <select name="category" class="category-select">
            <option value="">カテゴリ</option>
            <option value="焼肉" th:selected="${param.category == '焼肉'}">焼肉</option>
            <option value="寿司" th:selected="${param.category == '寿司'}">寿司</option>
            <option value="ラーメン" th:selected="${param.category == 'ラーメン'}">ラーメン</option>
            <option value="居酒屋" th:selected="${param.category == '居酒屋'}">居酒屋</option>
        </select>

        <button type="submit">検索</button>
    </form>

    <!-- 並び替えフォーム -->
    <form method="get" action="/stores" class="sort-form">
        <input type="hidden" name="keyword" th:value="${param.keyword}">
        <input type="hidden" name="category" th:value="${param.category}">

        <select name="sort">
            <option value="">並び替え</option>
            <option value="rating_desc" th:selected="${param.sort == 'rating_desc'}">
                評価が高い順
            </option>
            <option value="review_desc" th:selected="${param.sort == 'review_desc'}">
                口コミ数が多い順
            </option>
        </select>

        <button type="submit">適用</button>
    </form>

    <!-- 店舗一覧 -->
    <div class="store-list">
        <div class="store-card" th:each="store : ${stores}">

           <div class="store-image">
			   
          <img
  th:src="@{/storage/{file}(file=${store.imageName})}"
  alt="店舗画像"
  style="width:100%; height:140px; object-fit:cover;"
>

            <div class="store-body">
                <h3 class="store-name" th:text="${store.name}">店名</h3>

                <div class="store-rating">
                    <span class="stars">★★★★☆</span>
                    <span class="rating-score">4.2</span>
                </div>

                <div class="store-meta">
                    <span class="category-tag"
                          th:text="${store.categoryName}">
                        焼肉
                    </span>
                    <span class="favorite">♡ 12</span>
                </div>
               
                <div class="store-detail-link">
                <a th:href="@{/stores/__${store.id}__}">詳細を見る</a>
                </div>
                
            </div>

        </div>
    </div>

    <!-- 店舗が0件のとき -->
    <p th:if="${#lists.isEmpty(stores)}">
        該当する店舗がありません。
    </p>

</main>

<div th:replace="~{fragment :: footer}"></div>
<div th:replace="~{fragment :: scripts}"></div>

</body>
</html>