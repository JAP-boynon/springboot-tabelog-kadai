<!DOCTYPE html>

<html xmlns:th="https://www.thymeleaf.org" 
xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>NAGOYAMESHI</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet">
  <!-- Bootstrap（スライド用） -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div th:replace="~{fragment :: header}"></div>
<!--
<header class="header">
  <h1 class="logo-text">NAGOYAMESHI</h1>
</header>
-->

<!-- ===== トップ画像スライド ===== -->
<div class="hero">

  <div id="topCarousel" class="carousel slide"
       data-bs-ride="carousel"
       data-bs-interval="3000">

    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="/images/top/hitsumabusi.jpeg" class="d-block w-100 top-image">
      </div>
      <div class="carousel-item">
        <img src="/images/top/yakiniku.jpeg" class="d-block w-100 top-image">
      </div>
      <div class="carousel-item">
        <img src="/images/top/udonn.jpeg" class="d-block w-100 top-image">
      </div>
      <div class="carousel-item">
        <img src="/images/top/odenn.jpeg" class="d-block w-100 top-image">
      </div>
    </div>

  </div>

  <!-- 👇 画像の上に載せる文字 -->
  <div class="hero-text">
    <h2>名古屋の美味しいご飯を探そう</h2>
    <p>NAGOYAMESHIは名古屋B級グルメ専門サイトです</p>
  </div>

</div>

<!-- ===== ここから今までの検索エリア ===== -->
<main class="top">
	<!-- ログイン／ログアウトメッセージ -->
  <div class="container mt-3">

    <div th:if="${param.loggedIn}" class="alert alert-info text-center">
      ログインしました
    </div>

    <div th:if="${param.loggedOut}" class="alert alert-info text-center">
      ログアウトしました
    </div>
    
    <div
  th:if="${successMessage}"
  class="alert alert-success text-center"
  th:text="${successMessage}">
</div>
    
   

  </div>
  <h2>NAGOYAのB級グルメを探す</h2>

<form th:action="@{/stores}" method="get" class="search-form">
  <input type="text" name="keyword" placeholder="店舗名で検索">

  <!-- カテゴリは一旦使わないので hidden -->
  <input type="hidden" name="category" value="">
  <span class="badge bg-secondary">すべてのカテゴリ</span>

  <button type="submit" class="search-btn">検索</button>
</form>
  
  <section class="top-section">
  <h2 class="section-title">評価が高いお店</h2>
<div class="store-grid">
  <a th:each="store : ${highRatedStores}"
     th:href="@{/stores/{id}(id=${store.id})}"
     class="store-card top-store-card">
   
     
     <img th:if="${store.imageName != null}"
     th:src="@{/storage/{file}(file=${store.imageName})}"
      alt="店舗画像">

<img th:unless="${store.imageName != null}"
     th:src="@{/images/no-image.png}"
     alt="NO IMAGE">
   
     
   <div class="store-rating">
  <div class="stars"
       th:with="
         rating=${store.averageRating ?: 0},
         full=${T(java.lang.Math).floor(rating)},
         half=${rating - full >= 0.5}
       ">

    <span th:each="i : ${#numbers.sequence(1,5)}">
      <span th:if="${i <= full}" class="star-full">★</span>
      <span th:if="${i == full + 1 and half}" class="star-half">★</span>
      <span th:if="${i > full + (half ? 1 : 0)}" class="star-empty">★</span>
    </span>
  </div>

  <span class="rating-score"
        th:text="${#numbers.formatDecimal(store.averageRating ?: 0, 1, 1)}">
  </span>
</div>


  <span class="category-badge"
        th:text="${store.categoryName}"></span>
</div>
  </a>
</div>
  </section>


<section class="top-section">
<h2 class="section-title">新着のお店</h2>
<div class="store-grid">
  <a th:each="store : ${newStores}"
     th:href="@{/stores/{id}(id=${store.id})}"
     class="store-card top-store-card">
     
     <img th:if="${store.imageName != null}"
     th:src="@{/storage/{file}(file=${store.imageName})}"
     alt="店舗画像">

    <img th:unless="${store.imageName != null}"
     th:src="@{/images/no-image.png}"
     alt="NO IMAGE">
    
    <div class="store-info">
      <h3 th:text="${store.name}"></h3>
      <span th:text="${store.categoryName}"></span>
    </div>
  </a>
</div>
</section>


  <section class="top-section">
  <h3 class="section-title">カテゴリから探す</h3>

  <div class="category-tags">
    <a th:href="@{/stores(category='居酒屋')}" class="category-tag">居酒屋</a>
    <a th:href="@{/stores(category='焼肉')}" class="category-tag">焼肉</a>
    <a th:href="@{/stores(category='寿司')}" class="category-tag">寿司</a>
    <a th:href="@{/stores(category='定食')}" class="category-tag">定食</a>
    <a th:href="@{/stores(category='カレー')}" class="category-tag">カレー</a>
    <a th:href="@{/stores(category='中華料理')}" class="category-tag">中華料理</a>
    <a th:href="@{/stores(category='韓国料理')}" class="category-tag">韓国料理</a>
    <a th:href="@{/stores(category='イタリア料理')}" class="category-tag">イタリア料理</a>
    <a th:href="@{/stores(category='お好み焼き')}" class="category-tag">お好み焼き</a>
    <a th:href="@{/stores(category='たこ焼き')}" class="category-tag">たこ焼き</a>
    <a th:href="@{/stores(category='天ぷら')}" class="category-tag">天ぷら</a>
    <a th:href="@{/stores(category='しゃぶしゃぶ')}" class="category-tag">しゃぶしゃぶ</a>
    <a th:href="@{/stores(category='スイーツ')}" class="category-tag">スイーツ</a>
  </div>
</section>

<section class="top-section">
  <h2 class="section-title">条件を指定して探す</h2>

  <div class="feature-grid">

    <a th:href="@{/stores?feature=private_room}" class="feature-card">
     <img src="/images/features/private-room.jpg" alt="個室ありの店舗">
      <span>個室あり</span>
    </a>

    <a th:href="@{/stores?feature=all_you_can_drink}" class="feature-card">
      <img src="/images/features/drink.jpg" alt="飲み放題のある店舗">
      <span>飲み放題</span>
    </a>

    <a th:href="@{/stores?feature=takeout}" class="feature-card">
      <img src="/images/features/takeout.jpg" alt="テイクアウト可能な店舗">
      <span>テイクアウト</span>
    </a>

    <a th:href="@{/stores?feature=late_night}" class="feature-card">
      <img src="/images/features/night.jpg" alt="深夜営業している店舗">
      <span>深夜営業</span>
    </a>

  </div>
</section>


</main>

<div th:replace="~{fragment :: footer}"></div>
<div th:replace="~{fragment :: scripts}"></div>

<!-- トップページ専用 -->
<!--
<script th:src="@{/js/slider.js}"></script>
-->
</body>
</html>